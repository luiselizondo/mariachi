extends layout

block content
	script(type="text/template", class="addSite")
		div.row
			div(class="col-lg-12")
				h3 Add Site
				form(role="form").form-horizontal.well.row
					div.col-lg-6
						div.form-group
							label.control-label.col-sm-3 Name
							div.col-sm-9
								input(type="text", name="name", class="form-control", id="name")
								span.help-block Name of the Site
						div.form-group
							label.control-label.col-sm-3 FQDN
							div.col-sm-9
								input(type="text", name="fqdn", class="form-control", id="fqdn", placeholder="www.example.com")
								span.help-block Full Qualified Domain Name
						div.form-group
							label.control-label.col-sm-3 Web server
							div.col-sm-9
								select(name="webServer", id="webServer", class="form-control")
								span.help-block Web server (Only Apache is supported)
						div.form-group
							label.control-label.col-sm-3 Code archive
							div.col-sm-9
								input(type="text", name="codeArchive", class="form-control", id="codeArchive" placeholder="git@github.com/example:project.git")
								span.help-block Git address where the code lives, I must be able to clone the repository
						div.form-group
							label.control-label.col-sm-3 Code Branch
							div.col-sm-9
								input(type="text", name="codeBranch", class="form-control", id="codeBranch" placeholder="master")
								span.help-block Git branch to clone for the code
						div.form-group
							label.control-label.col-sm-3 Destination directory
							div.col-sm-9
								input(type="text", name="destinationDirectory", class="form-control", id="destinationDirectory", placeholder="/srv/www/www.example.com/public_html")
								span.help-block Destination directory, do not add a trailing slash
						div.form-group
							label.control-label.col-sm-3 Logs directory
							div.col-sm-9
								input(type="text", name="logsDirectory", class="form-control", id="logsDirectory", placeholder="/srv/www/www.example.com/logs")
								span.help-block Logs directory, do not add a trailing slash
					div.col-lg-6
						div.form-group
							label.control-label.col-sm-3 Database server
							div.col-sm-9
								select(name="databaseServer", id="databaseServer", class="form-control")
								span.help-block Web server
						div.form-group
							label.control-label.col-sm-3 Database archive
							div.col-sm-9
								input(type="text", name="databaseArchive", class="form-control", id="databaseArchive", placeholder="git@github.com/example:database.git")
								span.help-block Database must be gziped, example: database.sql.gz
						div.form-group
							label.control-label.col-sm-3 Database filename
							div.col-sm-9
								input(type="text", name="databaseFilename", class="form-control", id="databaseFilename", placeholder="mydatabase.sql.gz")
								span.help-block Filename of the database file to clone
						div.form-group
							label.control-label.col-sm-3 Database type
							div.col-sm-9
								select(name="databaseType", id="databaseType", class="form-control")
									option(value="mysql") MySQL
									option(value="mongodb") MongoDB
								span.help-block Database type
						div.form-group
							label.control-label.col-sm-3 Database name
							div.col-sm-9
								input(type="text", name="databaseName", class="form-control", id="databaseName", placeholder="mydatabase")
								span.help-block Name of the database
						div.form-group
							label.control-label.col-sm-3 Database user
							div.col-sm-9
								input(type="text", name="databaseUser", class="form-control", id="databaseUser", placeholder="root")
								span.help-block Database user
						div.form-group
							label.control-label.col-sm-3 Database password
							div.col-sm-9
								input(type="password", name="databasePassword", class="form-control", id="databasePassword", placeholder="cookies")
								span.help-block Database password
						div.form-group
							label.control-label.col-sm-3 Database port
							div.col-sm-9
								input(type="text", name="databasePort", class="form-control", id="databasePort", placeholder="3306")
								span.help-block Database port
						div.form-group
							label.control-label.col-sm-3 Create database and user?
							div.col-sm-9
								div.radio
									label
										input(type="radio", class="createDatabase", name="createDatabase", value="no" checked)
										p No
								div.radio
									label
										input(type="radio", class="createDatabase", name="createDatabase", value="yes") 
										p Yes
						div.form-database.hidden
							div.form-group
								label.control-label.col-sm-3 Database User with Privileges
								div.col-sm-9
									input(type="text", name="databaseUserRoot", id="databaseUserRoot", class="form-control")
							div.form-group
								label.control-label.col-sm-3 Password
								div.col-sm-9
									input(type="password", name="databasePasswordRoot", id="databasePasswordRoot", class="form-control")

					div.row
						button(type="submit", class="btn btn-primary", id="submit") Save
	script(type="text/template", class="editSite")
		div.row
			div(class="col-lg-6")
				h3 Add server
				form(role="form").well
					div.form-group
						label Name
						<input type="text" name="name" class="form-control" id="name" value="<%= name %>" />
						span.help-block Name
					div.form-group
						label Email
						<input type="text" name="email" class="form-control" id="email" value="<%= email %>" />
						span.help-block Email
					div.form-group
						label Password
						<input type="password" name="password" class="form-control" id="password />
						span.help-block Password
					button(type="submit", class="btn btn-primary", id="submit") Update
	script(type="text/template", class="viewSite")
		div.row
			div(class="col-lg-12 col-md-12 col-sm-12 col-xs-12")
				h3 <%= name %>
				div.well
					div.form-group
						label Name:
						p <%= name %>
					div.form-group
						label Email:  
						p <%= email %>
					div.form-group
						label Created:  
						p <%= created %>
	script(type="text/template", class="deleteSite")
		div 
			p 
				strong Are you sure you want to delete the Site <%= name %>?
		button(type="submit", id="submit").btn.btn-danger Confirm delete
		a(href="/Sites").btn.btn-primary Cancel
	script(type="text/template", class="listSites")
		div.well.well-sm 
			span Control your Sites here
		table.table.table-hover.table-striped
			thead
				th Name
				th Email
				th 
			tbody
				<% _.each(items, function(item) { %>
				tr.item
					td <%= item.name %>
					td <%= item.fqdn %>
					td 
						<a href="#sites/<%= item.id %>" class="btn btn-primary">View</a>
						<a href="#sites/edit/<%= item.id %>" class="btn btn-warning">Edit</a>
						<a href="#sites/delete/<%= item.id %>" class="btn btn-danger">Delete</a>
				<% }) %>
	div#page
		div.container
			div.row
				div(class="col-lg-12 col-md-12 col-sm-12 col-xs-12")
					h1= title
						div.pull-right
							a(href="#sites/add").btn.btn-primary Add Site
					hr
					div#messages
					div#content
block scripts
	script(type="text/javascript", src="javascripts/app/models/Models.js");
	script(type="text/javascript", src="javascripts/app/collections/Collections.js");
	script(type="text/javascript", src="javascripts/app/views/SitesView.js");
	script(type="text/javascript", src="javascripts/app/routers/SitesRouter.js")
	script(type="text/javascript")
		function main() {
			new Mariachi.Routers.SitesRouter();
			Backbone.history.start();	
		}

		// Initialize main
		$(function(){
			main();
		});